<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¼”ç¿’2: AzureéŸ³å£°ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ - è©³ç´°ã‚¬ã‚¤ãƒ‰</title>
    <style>
        :root {
            --primary-blue: #0066ff;
            --neon-cyan: #00ffff;
            --dark-bg: #1e1e1e;
            --darker-bg: #121212;
            --card-bg: #2a2a2a;
            --card-bg-light: #333333;
            --success-green: #00ff88;
            --warning-orange: #ffaa00;
            --error-red: #ff4466;
            --text-light: #ffffff;
            --text-muted: #b0b0b0;
            --white: #FFFFFF;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'DejaVu Sans', 'Noto Sans JP', sans-serif;
            line-height: 1.8;
            color: var(--text-light);
            background: var(--dark-bg);
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            background: linear-gradient(135deg, var(--darker-bg), var(--dark-bg));
            padding: 3rem 2rem;
            text-align: center;
            border-bottom: 3px solid var(--success-green);
            position: relative;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(circle at 20% 50%, rgba(0, 255, 136, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 80% 50%, rgba(0, 255, 255, 0.1) 0%, transparent 50%);
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--success-green), var(--neon-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
        }

        header p {
            color: var(--text-muted);
            font-size: 1.2rem;
            position: relative;
        }

        .breadcrumb {
            padding: 1rem 2rem;
            background: var(--darker-bg);
        }

        .breadcrumb a {
            color: var(--neon-cyan);
            text-decoration: none;
        }

        section {
            padding: 3rem 0;
            border-bottom: 1px solid rgba(0, 255, 136, 0.2);
        }

        section:last-of-type {
            border-bottom: none;
        }

        h2 {
            font-size: 2rem;
            color: var(--white);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--success-green);
            display: inline-block;
        }

        h3 {
            font-size: 1.5rem;
            color: var(--success-green);
            margin: 2rem 0 1rem;
        }

        h4 {
            font-size: 1.2rem;
            color: var(--white);
            margin: 1.5rem 0 0.5rem;
        }

        p {
            margin-bottom: 1rem;
            color: var(--text-muted);
        }

        .card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 2rem;
            margin: 1.5rem 0;
            border: 1px solid rgba(0, 255, 136, 0.2);
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }

        .info-card {
            background: linear-gradient(135deg, rgba(0, 102, 255, 0.1), rgba(0, 255, 255, 0.05));
            border-left: 4px solid var(--primary-blue);
        }

        .success-card {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1), rgba(0, 255, 136, 0.02));
            border-left: 4px solid var(--success-green);
        }

        .warning-card {
            background: linear-gradient(135deg, rgba(255, 170, 0, 0.1), rgba(255, 170, 0, 0.02));
            border-left: 4px solid var(--warning-orange);
        }

        .danger-card {
            background: linear-gradient(135deg, rgba(255, 68, 102, 0.1), rgba(255, 68, 102, 0.02));
            border-left: 4px solid var(--error-red);
        }

        ul, ol {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        li {
            margin: 0.5rem 0;
            color: var(--text-muted);
        }

        li strong {
            color: var(--white);
        }

        code {
            background: var(--darker-bg);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            color: var(--success-green);
            font-size: 0.9rem;
        }

        pre {
            background: var(--darker-bg);
            border-radius: 10px;
            padding: 1.5rem;
            overflow-x: auto;
            margin: 1rem 0;
            border: 1px solid rgba(0, 255, 136, 0.2);
        }

        pre code {
            background: none;
            padding: 0;
            color: var(--text-light);
        }

        .architecture-diagram {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem 0;
            text-align: center;
        }

        .flow-container {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
            margin: 2rem 0;
        }

        .flow-item {
            background: linear-gradient(135deg, var(--card-bg-light), var(--card-bg));
            border: 2px solid var(--success-green);
            border-radius: 15px;
            padding: 1.5rem;
            min-width: 150px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .flow-item:hover {
            transform: scale(1.05);
            border-color: var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }

        .flow-item .icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .flow-item strong {
            display: block;
            color: var(--white);
            font-size: 1.1rem;
        }

        .flow-item span {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .flow-arrow {
            font-size: 2rem;
            color: var(--success-green);
        }

        .safety-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .safety-item {
            background: linear-gradient(135deg, rgba(255, 68, 102, 0.2), rgba(255, 68, 102, 0.05));
            border: 2px solid var(--error-red);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
        }

        .safety-item .icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .safety-item strong {
            display: block;
            color: var(--error-red);
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .safety-item code {
            display: block;
            margin-top: 0.5rem;
            background: var(--darker-bg);
            padding: 0.5rem;
            border-radius: 5px;
        }

        .file-tree {
            background: var(--darker-bg);
            border-radius: 10px;
            padding: 1.5rem;
            font-family: 'Consolas', monospace;
            margin: 1rem 0;
        }

        .file-tree ul {
            list-style: none;
            padding-left: 1.5rem;
        }

        .file-tree li {
            color: var(--text-muted);
            padding: 0.2rem 0;
        }

        .file-tree li::before {
            content: 'â”œâ”€â”€ ';
            color: var(--text-muted);
        }

        .file-tree li:last-child::before {
            content: 'â””â”€â”€ ';
        }

        .file-tree .folder {
            color: var(--success-green);
        }

        .file-tree .file {
            color: var(--neon-cyan);
        }

        .badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
            margin: 0.2rem;
        }

        .badge-green {
            background: var(--success-green);
            color: var(--dark-bg);
        }

        .badge-orange {
            background: var(--warning-orange);
            color: var(--dark-bg);
        }

        .badge-red {
            background: var(--error-red);
            color: var(--white);
        }

        .step-list {
            counter-reset: step-counter;
            list-style: none;
            padding: 0;
        }

        .step-list li {
            counter-increment: step-counter;
            position: relative;
            padding-left: 3.5rem;
            margin: 1.5rem 0;
        }

        .step-list li::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            width: 2.5rem;
            height: 2.5rem;
            background: linear-gradient(135deg, var(--success-green), var(--neon-cyan));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark-bg);
            font-weight: bold;
            font-size: 1.1rem;
        }

        .loop-diagram {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 2rem 0;
            position: relative;
        }

        .loop-box {
            background: var(--card-bg);
            border: 2px dashed var(--warning-orange);
            border-radius: 20px;
            padding: 2rem;
            position: relative;
        }

        .loop-label {
            position: absolute;
            top: -15px;
            left: 20px;
            background: var(--warning-orange);
            color: var(--dark-bg);
            padding: 0.3rem 1rem;
            border-radius: 10px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .back-link {
            display: inline-block;
            margin-top: 2rem;
            padding: 1rem 2rem;
            background: var(--success-green);
            color: var(--dark-bg);
            text-decoration: none;
            border-radius: 10px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .back-link:hover {
            background: var(--neon-cyan);
        }

        footer {
            background: var(--darker-bg);
            text-align: center;
            padding: 2rem;
            margin-top: 3rem;
            border-top: 1px solid rgba(0, 255, 136, 0.2);
        }

        footer p {
            color: var(--text-muted);
            margin: 0;
        }

        @media (max-width: 768px) {
            .flow-container {
                flex-direction: column;
            }
            .flow-arrow {
                transform: rotate(90deg);
            }
            .safety-grid {
                grid-template-columns: 1fr;
            }
            header h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="breadcrumb">
        <a href="../20251202_Azure_AI_Agent_ãƒãƒ³ã‚ºã‚ªãƒ³.html">â† ãƒ¡ã‚¤ãƒ³è¬›ç¾©ã«æˆ»ã‚‹</a>
    </div>

    <header>
        <h1>ğŸ™ï¸ æ¼”ç¿’2: AzureéŸ³å£°ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ</h1>
        <p>02_azure-voice-chatbot è©³ç´°ã‚¬ã‚¤ãƒ‰</p>
    </header>

    <div class="container">
        <!-- WHY ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section id="why">
            <h2>ğŸ¤” WHY - ãªãœã“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãªã®ã‹</h2>

            <div class="card danger-card">
                <h3>âš ï¸ éŸ³å£°å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ ã®å±é™ºæ€§</h3>
                <p>éŸ³å£°å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ ã¯ã€Œæš´èµ°ã€ã®ãƒªã‚¹ã‚¯ãŒç‰¹ã«é«˜ã„ã§ã™ï¼š</p>
                <ul>
                    <li><strong>ç„¡é™ãƒ«ãƒ¼ãƒ—</strong>: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒçµ‚äº†ã‚’è¨€ã‚ãªã„é™ã‚Šæ°¸é ã«ç¶šãå¯èƒ½æ€§</li>
                    <li><strong>ã‚³ã‚¹ãƒˆçˆ†ç™º</strong>: éŸ³å£°èªè­˜ï¼‹LLMï¼‹éŸ³å£°åˆæˆã®3é‡èª²é‡‘</li>
                    <li><strong>ãƒªã‚½ãƒ¼ã‚¹æ¯æ¸‡</strong>: ãƒ¡ãƒ¢ãƒªã‚„APIåˆ¶é™ã®æ¶ˆè²»</li>
                    <li><strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®æ‚ªåŒ–</strong>: ã‚¨ãƒ©ãƒ¼ãŒé€£ç¶šã™ã‚‹ã¨ã‚¤ãƒ©ã‚¤ãƒ©ã‚’æ‹›ã</li>
                </ul>
            </div>

            <div class="card success-card">
                <h3>âœ… å®‰å…¨è¨­è¨ˆã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</h3>
                <p>ã€Œåˆ¶é™ã‚’æœ€åˆã‹ã‚‰è¨­è¨ˆã«çµ„ã¿è¾¼ã‚€ã€ã“ã¨ã§å®‰å…¨ã‚’ç¢ºä¿ã—ã¾ã™ï¼š</p>
                <ul>
                    <li><strong>ã‚¿ãƒ¼ãƒ³æ•°åˆ¶é™</strong>: æœ€å¤§ä¼šè©±å›æ•°ã‚’è¨­å®š</li>
                    <li><strong>ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ</strong>: ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“ã®ä¸Šé™</li>
                    <li><strong>é€£ç¶šã‚¨ãƒ©ãƒ¼åˆ¶é™</strong>: ã‚¨ãƒ©ãƒ¼ãŒç¶šã„ãŸã‚‰åœæ­¢</li>
                    <li><strong>æ˜ç¤ºçš„ãªçµ‚äº†ã‚³ãƒãƒ³ãƒ‰</strong>: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç°¡å˜ã«çµ‚äº†å¯èƒ½</li>
                </ul>
            </div>

            <div class="card warning-card">
                <h3>ğŸ’¡ è¨­è¨ˆæ€æƒ³: "Fail-Safe"</h3>
                <p>ã€Œä½•ã‹å•é¡ŒãŒèµ·ããŸã‚‰å®‰å…¨ãªçŠ¶æ…‹ã«æˆ»ã‚‹ã€ã¨ã„ã†åŸå‰‡ã«å¾“ã„ã¾ã™ã€‚</p>
                <p style="color: var(--warning-orange); font-weight: bold;">ã€Œå‹•ãç¶šã‘ã‚‹ã€ã‚ˆã‚Šã‚‚ã€Œå®‰å…¨ã«æ­¢ã¾ã‚‹ã€ã‚’å„ªå…ˆã™ã‚‹è¨­è¨ˆ</p>
            </div>
        </section>

        <!-- WHAT ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section id="what">
            <h2>ğŸ“‹ WHAT - ä½•ã‚’ä½œã‚‹ã®ã‹</h2>

            <h3>ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦</h3>
            <div class="architecture-diagram">
                <div class="loop-diagram">
                    <div class="loop-box">
                        <div class="loop-label">ğŸ”„ å¯¾è©±ãƒ«ãƒ¼ãƒ—</div>
                        <div class="flow-container">
                            <div class="flow-item">
                                <div class="icon">ğŸ¤</div>
                                <strong>Speech-to-Text</strong>
                                <span>Azure Speech</span>
                            </div>
                            <div class="flow-arrow">â†’</div>
                            <div class="flow-item" style="border-color: var(--primary-blue);">
                                <div class="icon">ğŸ¤–</div>
                                <strong>VoiceAgent</strong>
                                <span>GPT-5</span>
                            </div>
                            <div class="flow-arrow">â†’</div>
                            <div class="flow-item">
                                <div class="icon">ğŸ”Š</div>
                                <strong>Text-to-Speech</strong>
                                <span>Azure Speech</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <h3>ğŸ›¡ï¸ å®‰å…¨æ©Ÿæ§‹ï¼ˆæœ€é‡è¦ï¼‰</h3>
            <div class="safety-grid">
                <div class="safety-item">
                    <div class="icon">ğŸ”¢</div>
                    <strong>ã‚¿ãƒ¼ãƒ³æ•°åˆ¶é™</strong>
                    <p style="font-size: 0.85rem; color: var(--text-muted);">æœ€å¤§ä¼šè©±å›æ•°</p>
                    <code>MAX_CONVERSATION_TURNS</code>
                </div>
                <div class="safety-item">
                    <div class="icon">â±ï¸</div>
                    <strong>ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“åˆ¶é™</strong>
                    <p style="font-size: 0.85rem; color: var(--text-muted);">æœ€å¤§ç¶™ç¶šæ™‚é–“</p>
                    <code>MAX_SESSION_DURATION</code>
                </div>
                <div class="safety-item">
                    <div class="icon">âŒ</div>
                    <strong>é€£ç¶šã‚¨ãƒ©ãƒ¼åˆ¶é™</strong>
                    <p style="font-size: 0.85rem; color: var(--text-muted);">ã‚¨ãƒ©ãƒ¼å›æ•°ä¸Šé™</p>
                    <code>MAX_CONSECUTIVE_ERRORS</code>
                </div>
            </div>

            <h3>ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</h3>
            <div class="card-grid">
                <div class="card" style="border-top: 4px solid var(--success-green);">
                    <h4>ğŸ¤ SpeechRecognizer</h4>
                    <p>Azure Speech-to-Textã‚’ä½¿ç”¨</p>
                    <ul>
                        <li>ãƒã‚¤ã‚¯ã‹ã‚‰éŸ³å£°ã‚’å–å¾—</li>
                        <li>æ—¥æœ¬èªãƒ†ã‚­ã‚¹ãƒˆã«å¤‰æ›</li>
                        <li>å†è©¦è¡Œæ©Ÿèƒ½ä»˜ã</li>
                    </ul>
                    <p style="font-size: 0.85rem;"><code>speech/recognizer.py</code></p>
                </div>

                <div class="card" style="border-top: 4px solid var(--primary-blue);">
                    <h4>ğŸ¤– VoiceAgentSession</h4>
                    <p>GPT-5ãƒ™ãƒ¼ã‚¹ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</p>
                    <ul>
                        <li>ãƒãƒ«ãƒã‚¿ãƒ¼ãƒ³ä¼šè©±å¯¾å¿œ</li>
                        <li>ä¼šè©±å±¥æ­´ã®ç®¡ç†</li>
                        <li>éŸ³å£°å‘ã‘ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</li>
                    </ul>
                    <p style="font-size: 0.85rem;"><code>agents/voice_agent.py</code></p>
                </div>

                <div class="card" style="border-top: 4px solid var(--neon-cyan);">
                    <h4>ğŸ”Š SpeechSynthesizer</h4>
                    <p>Azure Text-to-Speechã‚’ä½¿ç”¨</p>
                    <ul>
                        <li>ãƒ†ã‚­ã‚¹ãƒˆã‚’éŸ³å£°åŒ–</li>
                        <li>è©±é€Ÿèª¿æ•´å¯èƒ½</li>
                        <li>è¤‡æ•°éŸ³å£°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«</li>
                    </ul>
                    <p style="font-size: 0.85rem;"><code>speech/synthesizer.py</code></p>
                </div>

                <div class="card" style="border-top: 4px solid var(--error-red);">
                    <h4>ğŸ›¡ï¸ VoiceChat</h4>
                    <p>å®‰å…¨ãªå¯¾è©±ãƒ«ãƒ¼ãƒ—ç®¡ç†</p>
                    <ul>
                        <li>å®‰å…¨åˆ¶é™ã®ãƒã‚§ãƒƒã‚¯</li>
                        <li>çµ‚äº†ã‚³ãƒãƒ³ãƒ‰æ¤œå‡º</li>
                        <li>çµ±è¨ˆæƒ…å ±ã®è¡¨ç¤º</li>
                    </ul>
                    <p style="font-size: 0.85rem;"><code>voice_chat.py</code></p>
                </div>
            </div>

            <h3>ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ</h3>
            <div class="file-tree">
                <span class="folder">02_azure-voice-chatbot/</span>
                <ul>
                    <li><span class="folder">speech/</span> - éŸ³å£°å‡¦ç†
                        <ul>
                            <li><span class="file">recognizer.py</span> - éŸ³å£°èªè­˜</li>
                            <li><span class="file">synthesizer.py</span> - éŸ³å£°åˆæˆ</li>
                        </ul>
                    </li>
                    <li><span class="folder">agents/</span> - ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾©
                        <ul>
                            <li><span class="file">voice_agent.py</span> - éŸ³å£°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</li>
                            <li><span class="file">base.py</span> - å…±é€šåŸºç›¤</li>
                        </ul>
                    </li>
                    <li><span class="folder">config/</span> - è¨­å®š
                        <ul>
                            <li><span class="file">settings.py</span> - å®‰å…¨è¨­å®šå«ã‚€</li>
                            <li><span class="file">voice_profiles.py</span> - éŸ³å£°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«</li>
                        </ul>
                    </li>
                    <li><span class="folder">tools/</span> - ãƒ„ãƒ¼ãƒ«
                        <ul>
                            <li><span class="file">context_manager.py</span></li>
                            <li><span class="file">conversation_summarizer.py</span></li>
                        </ul>
                    </li>
                    <li><span class="file">voice_chat.py</span> - å¯¾è©±ãƒ«ãƒ¼ãƒ—ç®¡ç†</li>
                    <li><span class="file">main.py</span> - ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ</li>
                </ul>
            </div>
        </section>

        <!-- HOW ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section id="how">
            <h2>ğŸ”§ HOW - ã©ã†å‹•ã‹ã™ã®ã‹</h2>

            <h3>ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †</h3>
            <ol class="step-list">
                <li>
                    <strong>ç’°å¢ƒå¤‰æ•°ã®è¨­å®š</strong>
                    <p><code>.env</code>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ</p>
                    <pre><code># .env
# Azure OpenAI
AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com/
AZURE_OPENAI_API_KEY=your-openai-api-key

# Azure Speech Service
AZURE_SPEECH_KEY=your-speech-api-key
AZURE_SPEECH_REGION=japaneast</code></pre>
                </li>
                <li>
                    <strong>ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</strong>
                    <pre><code>cd 02_azure-voice-chatbot
uv pip install -r requirements.txt</code></pre>
                </li>
                <li>
                    <strong>ãƒã‚¤ã‚¯ã®ç¢ºèª</strong>
                    <p>PCã®ãƒã‚¤ã‚¯ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„</p>
                </li>
                <li>
                    <strong>å®Ÿè¡Œ</strong>
                    <pre><code>python main.py</code></pre>
                </li>
            </ol>

            <h3>ã‚³ãƒ¼ãƒ‰ã®ãƒã‚¤ãƒ³ãƒˆè§£èª¬</h3>

            <div class="card danger-card">
                <h4>ğŸ›¡ï¸ å®‰å…¨åˆ¶é™ã®ãƒã‚§ãƒƒã‚¯ (voice_chat.py)</h4>
                <p><strong>æœ€ã‚‚é‡è¦ãªéƒ¨åˆ†</strong>: æ¯ã‚¿ãƒ¼ãƒ³é–‹å§‹å‰ã«å®‰å…¨åˆ¶é™ã‚’ãƒã‚§ãƒƒã‚¯</p>
                <pre><code>def _check_safety_limits(self) -> tuple[bool, Optional[str]]:
    # ã‚¿ãƒ¼ãƒ³æ•°åˆ¶é™
    if self.turn_count >= settings.MAX_CONVERSATION_TURNS:
        return False, f"æœ€å¤§ã‚¿ãƒ¼ãƒ³æ•°ï¼ˆ{settings.MAX_CONVERSATION_TURNS}ï¼‰ã«åˆ°é”ã—ã¾ã—ãŸ"

    # é€£ç¶šã‚¨ãƒ©ãƒ¼åˆ¶é™
    if self.consecutive_errors >= settings.MAX_CONSECUTIVE_ERRORS:
        return False, f"é€£ç¶šã‚¨ãƒ©ãƒ¼ãŒ{settings.MAX_CONSECUTIVE_ERRORS}å›ç™ºç”Ÿã—ã¾ã—ãŸ"

    # ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“åˆ¶é™
    if self.session_start_time:
        elapsed = time.time() - self.session_start_time
        if elapsed > settings.MAX_SESSION_DURATION:
            return False, f"æœ€å¤§ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“ã‚’è¶…éã—ã¾ã—ãŸ"

    return True, None</code></pre>
                <p style="margin-top: 1rem; color: var(--error-red);"><strong>æ³¨ç›®:</strong> 3ã¤ã®åˆ¶é™ã®ã©ã‚Œã‹1ã¤ã§ã‚‚è¶…ãˆãŸã‚‰å³åº§ã«åœæ­¢</p>
            </div>

            <div class="card info-card">
                <h4>ğŸ”„ å¯¾è©±ãƒ«ãƒ¼ãƒ—ã®æ§‹é€ </h4>
                <pre><code>while True:
    # 1. å®‰å…¨åˆ¶é™ãƒã‚§ãƒƒã‚¯ï¼ˆæœ€åˆã«å¿…ãšå®Ÿè¡Œï¼‰
    can_continue, stop_reason = self._check_safety_limits()
    if not can_continue:
        break

    # 2. éŸ³å£°èªè­˜ï¼ˆå†è©¦è¡Œæ©Ÿèƒ½ä»˜ãï¼‰
    success, user_text = self.recognizer.recognize_once()

    # 3. çµ‚äº†ã‚³ãƒãƒ³ãƒ‰ãƒã‚§ãƒƒã‚¯
    if self._is_exit_command(user_text):
        break

    # 4. ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå‡¦ç†
    assistant_response = await self.session.send_message(user_text)

    # 5. éŸ³å£°åˆæˆ
    self.synthesizer.speak(assistant_response)

    # 6. ã‚¿ãƒ¼ãƒ³æ•°ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
    self.turn_count += 1</code></pre>
            </div>

            <div class="card success-card">
                <h4>ğŸ™ï¸ éŸ³å£°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</h4>
                <p>éŸ³å£°å¯¾è©±ã«ç‰¹åŒ–ã—ãŸã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¨­å®š</p>
                <pre><code>VOICE_AGENT_INSTRUCTIONS = """
ã‚ãªãŸã¯è¦ªã—ã¿ã‚„ã™ãè‡ªç„¶ãªéŸ³å£°å¯¾è©±ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚

## å¯¾è©±ã‚¹ã‚¿ã‚¤ãƒ«
- éŸ³å£°ã§ã®èª­ã¿ä¸Šã’ã«é©ã—ãŸã€è‡ªç„¶ã§æµã‚Œã‚‹ã‚ˆã†ãªæ–‡ç« ã§å›ç­”ã™ã‚‹
- é•·ã™ãã‚‹å›ç­”ã¯é¿ã‘ã€è¦ç‚¹ã‚’ç°¡æ½”ã«ä¼ãˆã‚‹
- ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³è¨˜æ³•ã‚„ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã¯ä½¿ç”¨ã—ãªã„ï¼ˆéŸ³å£°ã«ã¯ä¸å‘ãï¼‰
- ç®‡æ¡æ›¸ãã¯ã€Œ1ã¤ç›®ã¯...ã€2ã¤ç›®ã¯...ã€ã®ã‚ˆã†ã«éŸ³å£°ã§åˆ†ã‹ã‚Šã‚„ã™ãè¡¨ç¾ã™ã‚‹
"""</code></pre>
                <p style="margin-top: 1rem;"><strong>æ³¨ç›®:</strong> ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒƒãƒˆã¨éŸ³å£°å¯¾è©±ã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å¤‰ãˆã‚‹å¿…è¦ãŒã‚ã‚‹</p>
            </div>
        </section>

        <!-- ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section id="quickstart">
            <h2>âš¡ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ - å‹•ä½œç¢ºèªæ–¹æ³•</h2>
            <p>git cloneãŠã‚ˆã³uv syncã—ãŸçŠ¶æ…‹ã‹ã‚‰ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§å‹•ä½œç¢ºèªãŒã§ãã¾ã™ã€‚</p>

            <div class="card" style="background: rgba(0, 255, 136, 0.1); border-left: 4px solid var(--success-green); margin: 2rem 0;">
                <h4 style="color: var(--success-green); margin-bottom: 1rem;">ğŸ¤ Azure Voice Chatbotã®å®Ÿè¡Œ</h4>
                <pre><code style="color: var(--neon-cyan);">cd 02_azure-voice-chatbot
uv run python main.py</code></pre>
                <p style="margin-top: 1rem; color: var(--text-muted);">
                    <strong>æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ:</strong><br>
                    âœ“ ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•<br>
                    âœ“ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹URLãŒè¡¨ç¤ºã•ã‚Œã‚‹<br>
                    âœ“ ãƒ–ãƒ©ã‚¦ã‚¶ã§UIãŒèµ·å‹•<br>
                    âœ“ ãƒã‚¤ã‚¯å…¥åŠ›ã§éŸ³å£°èªè­˜ãŒå‹•ä½œ<br>
                    âœ“ AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå‡¦ç†ã—ã¦éŸ³å£°ã§å¿œç­”<br>
                </p>
            </div>

            <div class="card" style="background: rgba(0, 255, 136, 0.05); border-left: 4px solid var(--warning-orange); margin: 2rem 0;">
                <h4 style="color: var(--warning-orange); margin-bottom: 1rem;">ğŸ“ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h4>
                <ul style="color: var(--text-muted);">
                    <li><strong>ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã‚¨ãƒ©ãƒ¼:</strong> <code style="background: var(--darker-bg); padding: 0.2rem 0.5rem; border-radius: 3px;">uv sync</code> ã‚’å†å®Ÿè¡Œã—ã¦ãã ã•ã„</li>
                    <li><strong>Azure OpenAI APIã‚¨ãƒ©ãƒ¼:</strong> <code style="background: var(--darker-bg); padding: 0.2rem 0.5rem; border-radius: 3px;">.env</code> ãƒ•ã‚¡ã‚¤ãƒ«ã®èªè¨¼æƒ…å ±ã‚’ç¢ºèªã—ã¦ãã ã•ã„</li>
                    <li><strong>ãƒã‚¤ã‚¯ãŒæ¤œå‡ºã•ã‚Œãªã„:</strong> ãƒ–ãƒ©ã‚¦ã‚¶ã®ä½¿ç”¨è¨±å¯ã‚’ç¢ºèªã—ã€ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã§ãƒã‚¤ã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã—ã¦ãã ã•ã„</li>
                    <li><strong>ãƒãƒ¼ãƒˆãŒæ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹:</strong> æ—¢å­˜ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†ã™ã‚‹ã‹ã€åˆ¥ã®ãƒãƒ¼ãƒˆã‚’æŒ‡å®šã—ã¦ãã ã•ã„</li>
                </ul>
            </div>

            <div class="card" style="background: rgba(0, 102, 255, 0.05); border-left: 4px solid var(--neon-cyan); margin: 2rem 0;">
                <h4 style="color: var(--neon-cyan); margin-bottom: 1rem;">ğŸ’¡ æ“ä½œã‚¬ã‚¤ãƒ‰</h4>
                <ul style="color: var(--text-muted);">
                    <li><strong>ãƒã‚¤ã‚¯å…¥åŠ›é–‹å§‹:</strong> ã€ŒğŸ¤ é–‹å§‹ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                    <li><strong>éŸ³å£°èªè­˜ä¸­:</strong> èµ¤ã„ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹</li>
                    <li><strong>å‡¦ç†ä¸­:</strong> ã€Œå‡¦ç†ä¸­...ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹</li>
                    <li><strong>çµæœç¢ºèª:</strong> ãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¤ºã¨éŸ³å£°å‡ºåŠ›ã®ä¸¡æ–¹ã§ç¢ºèªå¯èƒ½</li>
                    <li><strong>ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¥æ­´:</strong> ä¼šè©±å±¥æ­´ãŒç”»é¢å·¦å´ã«ä¿å­˜ã•ã‚Œã‚‹</li>
                </ul>
            </div>
        </section>

        <!-- NEXT STEP ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section id="nextstep">
            <h2>ğŸš€ NEXT STEP - å®Ÿå‹™ã§è¿½åŠ ãŒå¿…è¦ãªã“ã¨</h2>

            <div class="card-grid">
                <div class="card danger-card">
                    <h4>â— èªè¨¼ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</h4>
                    <ul>
                        <li>APIã‚­ãƒ¼ã®å®‰å…¨ãªç®¡ç†</li>
                        <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼</li>
                        <li>éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–</li>
                    </ul>
                </div>

                <div class="card danger-card">
                    <h4>â— éŸ³å£°å“è³ªã®èª¿æ•´</h4>
                    <ul>
                        <li>ãƒã‚¤ã‚ºé™¤å»</li>
                        <li>è©±è€…è­˜åˆ¥</li>
                        <li>æ–¹è¨€ãƒ»ã‚¢ã‚¯ã‚»ãƒ³ãƒˆå¯¾å¿œ</li>
                    </ul>
                </div>

                <div class="card warning-card">
                    <h4>âš ï¸ ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“å‘ä¸Š</h4>
                    <ul>
                        <li>å¾…æ©Ÿä¸­ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯éŸ³</li>
                        <li>å‰²ã‚Šè¾¼ã¿æ¤œå‡º</li>
                        <li>æ„Ÿæƒ…èªè­˜</li>
                    </ul>
                </div>

                <div class="card warning-card">
                    <h4>âš ï¸ é‹ç”¨ç›£è¦–</h4>
                    <ul>
                        <li>å¯¾è©±ãƒ­ã‚°ã®ä¿å­˜</li>
                        <li>ã‚¨ãƒ©ãƒ¼ç‡ã®ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°</li>
                        <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼æº€è¶³åº¦ã®è¨ˆæ¸¬</li>
                    </ul>
                </div>
            </div>

            <div class="card" style="margin-top: 2rem; text-align: center; background: linear-gradient(135deg, rgba(0, 255, 136, 0.2), rgba(0, 255, 255, 0.1)); border: 2px solid var(--success-green);">
                <h3 style="color: var(--white); margin-bottom: 1rem;">ğŸ¯ æŒã¡å¸°ã‚Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</h3>
                <p style="font-size: 1.3rem; color: var(--white);">
                    ã€ŒéŸ³å£°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯<strong style="color: var(--success-green);">æš´èµ°é˜²æ­¢ã®è¨­è¨ˆ</strong>ãŒå¿…é ˆã€‚<br>
                    MAX_TURNSã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã€ã‚¨ãƒ©ãƒ¼ä¸Šé™ã¯<br>
                    <strong style="color: var(--neon-cyan);">æœ€åˆã‹ã‚‰çµ„ã¿è¾¼ã‚€</strong>ã€
                </p>
            </div>
        </section>

        <!-- Phase 3 æ©Ÿèƒ½ -->
        <section id="phase3">
            <h2>ğŸ†• Phase 3 æ‹¡å¼µæ©Ÿèƒ½</h2>
            <p>æœ¬ã‚·ã‚¹ãƒ†ãƒ ã«ã¯Phase 3ã¨ã—ã¦ä»¥ä¸‹ã®æ‹¡å¼µæ©Ÿèƒ½ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ï¼š</p>

            <div class="card-grid">
                <div class="card">
                    <h4>ğŸ“ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç®¡ç†</h4>
                    <p>ä¼šè©±ã‹ã‚‰é‡è¦ãªæƒ…å ±ã‚’è‡ªå‹•æŠ½å‡ºã—ã€å¾Œç¶šã®ä¼šè©±ã§æ´»ç”¨</p>
                    <code>tools/context_manager.py</code>
                </div>
                <div class="card">
                    <h4>ğŸ“‹ ä¼šè©±è¦ç´„</h4>
                    <p>ã€Œè¦ç´„ã—ã¦ã€ã¨è¨€ã†ã¨ä¼šè©±ã®è¦ç‚¹ã‚’ã¾ã¨ã‚ã¦èª­ã¿ä¸Šã’</p>
                    <code>tools/conversation_summarizer.py</code>
                </div>
                <div class="card">
                    <h4>ğŸ¤ éŸ³å£°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«</h4>
                    <p>è¤‡æ•°ã®å£°è³ªã‚’åˆ‡ã‚Šæ›¿ãˆå¯èƒ½ï¼ˆç©ã‚„ã‹ã€å…ƒæ°—ã€è½ã¡ç€ã„ãŸç”·æ€§ãªã©ï¼‰</p>
                    <code>config/voice_profiles.py</code>
                </div>
                <div class="card">
                    <h4>âš¡ è©±é€Ÿèª¿æ•´</h4>
                    <p>ã€Œé€Ÿãã€ã€Œã‚†ã£ãã‚Šã€ã§è©±é€Ÿã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¤‰æ›´</p>
                    <code>voice_chat.py</code>
                </div>
            </div>
        </section>

        <!-- é–¢é€£ãƒªãƒ³ã‚¯ -->
        <section>
            <h2>ğŸ“š é–¢é€£ãƒªã‚½ãƒ¼ã‚¹</h2>
            <div class="card-grid">
                <div class="card">
                    <h4>ğŸ“ ç¢ºèªã‚¯ã‚¤ã‚º</h4>
                    <p>ç†è§£åº¦ã‚’ãƒã‚§ãƒƒã‚¯</p>
                    <a href="../question/02_azure-voice-chatbot_quiz.html" style="color: var(--success-green);">å•é¡Œã‚’è§£ã â†’</a>
                </div>
                <div class="card">
                    <h4>âœ… è§£ç­”ãƒ»è§£èª¬</h4>
                    <p>è©³ç´°ãªè§£èª¬ã‚’ç¢ºèª</p>
                    <a href="../answer/02_azure-voice-chatbot_answer.html" style="color: var(--success-green);">è§£ç­”ã‚’è¦‹ã‚‹ â†’</a>
                </div>
            </div>

            <a href="../20251202_Azure_AI_Agent_ãƒãƒ³ã‚ºã‚ªãƒ³.html" class="back-link">â† ãƒ¡ã‚¤ãƒ³è¬›ç¾©ã«æˆ»ã‚‹</a>
        </section>
    </div>

    <footer>
        <p>&copy; 2026 SB C&Sæ ªå¼ä¼šç¤¾ - Azure AI Agentãƒãƒ³ã‚ºã‚ªãƒ³</p>
    </footer>
</body>
</html>
